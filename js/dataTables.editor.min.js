/*!
 DataTables Editor v1.4.0-beta

 Â©2012-2014 SpryMedia Ltd, all rights reserved.
 License: editor.datatables.net/license
*/
(function(q,m,h){var y=function(c,v){function x(a){a=a.context[0];return a.oInit.editor||a._editor}function z(a,b,d,c){b||(b={});b.buttons===h&&(b.buttons="_basic");b.title===h&&(b.title=a.i18n[d].title);b.message===h&&("remove"===d?(a=a.i18n[d].confirm,b.message=1!==c?a._.replace(/%d/,c):a["1"]):b.message="");return b}if(!v||!v.versionCheck||!v.versionCheck("1.10"))throw"Editor requires DataTables 1.10 or newer";var e=function(a){!this instanceof e&&alert("DataTables Editor must be initialised as a 'new' instance'");
this._constructor(a)};v.Editor=e;c.fn.DataTable.Editor=e;var s=function(a,b){b===h&&(b=m);return c('*[data-dte-e="'+a+'"]',b)},y=0;e.Field=function(a,b,d){var k=this,a=c.extend(!0,{},e.Field.defaults,a);this.s=c.extend({},e.Field.settings,{type:e.fieldTypes[a.type],name:a.name,classes:b,host:d,opts:a});a.id||(a.id="DTE_Field_"+a.name);a.dataProp&&(a.data=a.dataProp);a.data||(a.data=a.name);var g=v.ext.oApi;this.valFromData=function(b){return g._fnGetObjectDataFn(a.data)(b,"editor")};this.valToData=
g._fnSetObjectDataFn(a.data);b=c('<div class="'+b.wrapper+" "+b.typePrefix+a.type+" "+b.namePrefix+a.name+" "+a.className+'"><label data-dte-e="label" class="'+b.label+'" for="'+a.id+'">'+a.label+'<div data-dte-e="msg-label" class="'+b["msg-label"]+'">'+a.labelInfo+'</div></label><div data-dte-e="input" class="'+b.input+'"><div data-dte-e="msg-error" class="'+b["msg-error"]+'"></div><div data-dte-e="msg-message" class="'+b["msg-message"]+'"></div><div data-dte-e="msg-info" class="'+b["msg-info"]+
'">'+a.fieldInfo+"</div></div></div>");d=this._typeFn("create",a);null!==d?s("input",b).prepend(d):b.css("display","none");this.dom=c.extend(!0,{},e.Field.models.dom,{container:b,label:s("label",b),fieldInfo:s("msg-info",b),labelInfo:s("msg-label",b),fieldError:s("msg-error",b),fieldMessage:s("msg-message",b)});c.each(this.s.type,function(a,b){typeof b==="function"&&k[a]===h&&(k[a]=function(){var b=Array.prototype.slice.call(arguments);b.unshift(a);b=k._typeFn.apply(k,b);return b===h?k:b})})};e.Field.prototype=
{dataSrc:function(){return this.s.opts.data},valFromData:null,valToData:null,destroy:function(){this.dom.container.remove();this._typeFn("destroy");return this},def:function(a){var b=this.s.opts;if(a===h)return a=b["default"]!==h?b["default"]:b.def,c.isFunction(a)?a():a;b.def=a;return this},disable:function(){this._typeFn("disable");return this},displayed:function(){var a=this.dom.container;return a.parents("body").length&&"none"!=a.css("display")?!0:!1},enable:function(){this._typeFn("enable");return this},
error:function(a,b){var d=this.s.classes;a?this.dom.container.addClass(d.error):this.dom.container.removeClass(d.error);return this._msg(this.dom.fieldError,a,b)},inError:function(){return this.dom.container.hasClass(this.s.classes.error)},focus:function(){this.s.type.focus?this._typeFn("focus"):c("input, select, textarea",this.dom.container).focus();return this},get:function(){var a=this._typeFn("get");return a!==h?a:this.def()},hide:function(a){var b=this.dom.container;a===h&&(a=!0);b.is(":visible")&&
a?b.slideUp():b.css("display","none");return this},label:function(a){var b=this.dom.label;if(a===h)return b.html();b.html(a);return this},message:function(a,b){return this._msg(this.dom.fieldMessage,a,b)},name:function(){return this.s.opts.name},node:function(){return this.dom.container[0]},set:function(a){return this._typeFn("set",a)},show:function(a){var b=this.dom.container;a===h&&(a=!0);!b.is(":visible")&&a?b.slideDown():b.css("display","block");return this},val:function(a){return a===h?this.get():
this.set(a)},_errorNode:function(){return this.dom.fieldError},_msg:function(a,b,d){a.parent().is(":visible")?(a.html(b),b?a.slideDown(d):a.slideUp(d)):(a.html(b||"").css("display",b?"block":"none"),d&&d());return this},_typeFn:function(a){var b=Array.prototype.slice.call(arguments);b.shift();b.unshift(this.s.opts);var d=this.s.type[a];if(d)return d.apply(this.s.host,b)}};e.Field.models={};e.Field.defaults={className:"",data:"",def:"",fieldInfo:"",id:"",label:"",labelInfo:"",name:null,type:"text"};
e.Field.models.settings={type:null,name:null,classes:null,opts:null,host:null};e.Field.models.dom={container:null,label:null,labelInfo:null,fieldInfo:null,fieldError:null,fieldMessage:null};e.models={};e.models.displayController={init:function(){},open:function(){},close:function(){}};e.models.fieldType={create:function(){},get:function(){},set:function(){},enable:function(){},disable:function(){}};e.models.settings={ajaxUrl:null,ajax:null,dataSource:null,domTable:null,opts:null,displayController:null,
fields:{},order:[],id:-1,displayed:!1,processing:!1,modifier:null,action:null,idSrc:null};e.models.button={label:null,fn:null,className:null};e.models.formOptions={submitOnReturn:!0,submitOnBlur:!1,blurOnBackground:!0,closeOnComplete:!0,onEsc:"close",focus:0,buttons:!0,title:!0,message:!0};e.display={};var o=jQuery,i;e.display.lightbox=o.extend(!0,{},e.models.displayController,{init:function(){i._init();return i},open:function(a,b,d){if(i._shown)d&&d();else{i._dte=a;a=i._dom.content;a.children().detach();
a.append(b).append(i._dom.close);i._shown=true;i._show(d)}},close:function(a,b){if(i._shown){i._dte=a;i._hide(b);i._shown=false}else b&&b()},_init:function(){if(!i._ready){var a=i._dom;a.content=o("div.DTED_Lightbox_Content",i._dom.wrapper);a.wrapper.css("opacity",0);a.background.css("opacity",0)}},_show:function(a){var b=i._dom;q.orientation!==h&&o("body").addClass("DTED_Lightbox_Mobile");b.content.css("height","auto");b.wrapper.css({top:-i.conf.offsetAni});o("body").append(i._dom.background).append(i._dom.wrapper);
i._heightCalc();b.wrapper.animate({opacity:1,top:0},a);b.background.animate({opacity:1});b.close.bind("click.DTED_Lightbox",function(){i._dte.close()});b.background.bind("click.DTED_Lightbox",function(){i._dte.blur()});o("div.DTED_Lightbox_Content_Wrapper",b.wrapper).bind("click.DTED_Lightbox",function(a){o(a.target).hasClass("DTED_Lightbox_Content_Wrapper")&&i._dte.blur()});o(q).bind("resize.DTED_Lightbox",function(){i._heightCalc()});i._scrollTop=o("body").scrollTop();if(q.orientation!==h){a=o("body").children().not(b.background).not(b.wrapper);
o("body").append('<div class="DTED_Lightbox_Shown"/>');o("div.DTED_Lightbox_Shown").append(a)}},_heightCalc:function(){var a=i._dom,b=o(q).height()-i.conf.windowPadding*2-o("div.DTE_Header",a.wrapper).outerHeight()-o("div.DTE_Footer",a.wrapper).outerHeight();o("div.DTE_Body_Content",a.wrapper).css("maxHeight",b)},_hide:function(a){var b=i._dom;a||(a=function(){});if(q.orientation!==h){var d=o("div.DTED_Lightbox_Shown");d.children().appendTo("body");d.remove()}o("body").removeClass("DTED_Lightbox_Mobile").scrollTop(i._scrollTop);
b.wrapper.animate({opacity:0,top:i.conf.offsetAni},function(){o(this).detach();a()});b.background.animate({opacity:0},function(){o(this).detach()});b.close.unbind("click.DTED_Lightbox");b.background.unbind("click.DTED_Lightbox");o("div.DTED_Lightbox_Content_Wrapper",b.wrapper).unbind("click.DTED_Lightbox");o(q).unbind("resize.DTED_Lightbox")},_dte:null,_ready:!1,_shown:!1,_dom:{wrapper:o('<div class="DTED DTED_Lightbox_Wrapper"><div class="DTED_Lightbox_Container"><div class="DTED_Lightbox_Content_Wrapper"><div class="DTED_Lightbox_Content"></div></div></div></div>'),
background:o('<div class="DTED_Lightbox_Background"><div/></div>'),close:o('<div class="DTED_Lightbox_Close"></div>'),content:null}});i=e.display.lightbox;i.conf={offsetAni:25,windowPadding:25};var l=jQuery,f;e.display.envelope=l.extend(!0,{},e.models.displayController,{init:function(a){f._dte=a;f._init();return f},open:function(a,b,d){f._dte=a;l(f._dom.content).children().detach();f._dom.content.appendChild(b);f._dom.content.appendChild(f._dom.close);f._show(d)},close:function(a,b){f._dte=a;f._hide(b)},
_init:function(){if(!f._ready){f._dom.content=l("div.DTED_Envelope_Container",f._dom.wrapper)[0];m.body.appendChild(f._dom.background);m.body.appendChild(f._dom.wrapper);f._dom.background.style.visbility="hidden";f._dom.background.style.display="block";f._cssBackgroundOpacity=l(f._dom.background).css("opacity");f._dom.background.style.display="none";f._dom.background.style.visbility="visible"}},_show:function(a){a||(a=function(){});f._dom.content.style.height="auto";var b=f._dom.wrapper.style;b.opacity=
0;b.display="block";var d=f._findAttachRow(),c=f._heightCalc(),g=d.offsetWidth;b.display="none";b.opacity=1;f._dom.wrapper.style.width=g+"px";f._dom.wrapper.style.marginLeft=-(g/2)+"px";f._dom.wrapper.style.top=l(d).offset().top+d.offsetHeight+"px";f._dom.content.style.top=-1*c-20+"px";f._dom.background.style.opacity=0;f._dom.background.style.display="block";l(f._dom.background).animate({opacity:f._cssBackgroundOpacity},"normal");l(f._dom.wrapper).fadeIn();f.conf.windowScroll?l("html,body").animate({scrollTop:l(d).offset().top+
d.offsetHeight-f.conf.windowPadding},function(){l(f._dom.content).animate({top:0},600,a)}):l(f._dom.content).animate({top:0},600,a);l(f._dom.close).bind("click.DTED_Envelope",function(){f._dte.close()});l(f._dom.background).bind("click.DTED_Envelope",function(){f._dte.blur()});l("div.DTED_Lightbox_Content_Wrapper",f._dom.wrapper).bind("click.DTED_Envelope",function(a){l(a.target).hasClass("DTED_Envelope_Content_Wrapper")&&f._dte.blur()});l(q).bind("resize.DTED_Envelope",function(){f._heightCalc()})},
_heightCalc:function(){f.conf.heightCalc?f.conf.heightCalc(f._dom.wrapper):l(f._dom.content).children().height();var a=l(q).height()-f.conf.windowPadding*2-l("div.DTE_Header",f._dom.wrapper).outerHeight()-l("div.DTE_Footer",f._dom.wrapper).outerHeight();l("div.DTE_Body_Content",f._dom.wrapper).css("maxHeight",a);return l(f._dte.dom.wrapper).outerHeight()},_hide:function(a){a||(a=function(){});l(f._dom.content).animate({top:-(f._dom.content.offsetHeight+50)},600,function(){l([f._dom.wrapper,f._dom.background]).fadeOut("normal",
a)});l(f._dom.close).unbind("click.DTED_Lightbox");l(f._dom.background).unbind("click.DTED_Lightbox");l("div.DTED_Lightbox_Content_Wrapper",f._dom.wrapper).unbind("click.DTED_Lightbox");l(q).unbind("resize.DTED_Lightbox")},_findAttachRow:function(){var a=l(f._dte.s.table).DataTable();return f.conf.attach==="head"?a.table().header():f._dte.s.action==="create"?a.table().header():a.row(f._dte.s.modifier).node()},_dte:null,_ready:!1,_cssBackgroundOpacity:1,_dom:{wrapper:l('<div class="DTED DTED_Envelope_Wrapper"><div class="DTED_Envelope_ShadowLeft"></div><div class="DTED_Envelope_ShadowRight"></div><div class="DTED_Envelope_Container"></div></div>')[0],
background:l('<div class="DTED_Envelope_Background"><div/></div>')[0],close:l('<div class="DTED_Envelope_Close">&times;</div>')[0],content:null}});f=e.display.envelope;f.conf={windowPadding:50,heightCalc:null,attach:"row",windowScroll:!0};e.prototype.add=function(a){if(c.isArray(a))for(var b=0,d=a.length;b<d;b++)this.add(a[b]);else{b=a.name;if(b===h)throw"Error adding field. The field requires a `name` option";if(this.s.fields[b])throw"Error adding field '"+b+"'. A field already exists with this name";
this._dataSource("initField",a);this.s.fields[b]=new e.Field(a,this.classes.field,this);this.s.order.push(b)}return this};e.prototype.blur=function(){this._blur();return this};e.prototype.bubble=function(a,b,d){var k=this,g,e;if(this._tidy(function(){k.bubble(a,b,d)}))return this;c.isPlainObject(b)&&(d=b,b=h);d=c.extend({},this.s.formOptions.bubble,d);b?(c.isArray(b)||(b=[b]),c.isArray(a)||(a=[a]),g=c.map(b,function(a){return k.s.fields[a]}),e=c.map(a,function(){return k._dataSource("individual",
a)})):(c.isArray(a)||(a=[a]),e=c.map(a,function(a){return k._dataSource("individual",a,null,k.s.fields)}),g=c.map(e,function(a){return a.field}));this.s.bubbleNodes=c.map(e,function(a){return a.node});e=c.map(e,function(a){return a.edit}).sort();if(e[0]!==e[e.length-1])throw"Editing is limited to a single row only";this._edit(e[0],"bubble");var f=this._formOptions(d);c(q).on("resize."+f,function(){k.bubblePosition()});if(!this._preopen("bubble"))return this;var n=this.classes.bubble;e=c('<div class="'+
n.wrapper+'"><div class="'+n.liner+'"><div class="'+n.table+'"><div class="'+n.close+'" /></div></div><div class="'+n.pointer+'" /></div>').appendTo("body");n=c('<div class="'+n.bg+'"><div/></div>').appendTo("body");this._displayReorder(g);var t=e.children().eq(0),i=t.children(),l=i.children();t.append(this.dom.formError);i.prepend(this.dom.form);d.message&&t.prepend(this.dom.formInfo);d.title&&t.prepend(this.dom.header);d.buttons&&i.append(this.dom.buttons);var j=c().add(e).add(n);this._closeReg(function(){j.animate({opacity:0},
function(){j.detach();c(q).off("resize."+f);k._clearDynamicInfo()})});n.click(function(){k.blur()});l.click(function(){k._close()});this.bubblePosition();j.animate({opacity:1});this._focus(g,d.focus);this._postopen("bubble");return this};e.prototype.bubblePosition=function(){var a=c("div.DTE_Bubble"),b=c("div.DTE_Bubble_Liner"),d=this.s.bubbleNodes,k=0,g=0,e=0;c.each(d,function(a,b){var d=c(b).offset();k+=d.top;g+=d.left;e+=d.left+b.offsetWidth});var k=k/d.length,g=g/d.length,e=e/d.length,d=k,f=(g+
e)/2,n=b.outerWidth(),t=f-n/2,n=t+n,h=c(q).width();a.css({top:d,left:f});n+15>h?b.css("left",15>t?-(t-15):-(n-h+15)):b.css("left",15>t?-(t-15):0);return this};e.prototype.buttons=function(a){var b=this;"_basic"===a?a=[{label:this.i18n[this.s.action].submit,fn:function(){this.submit()}}]:c.isArray(a)||(a=[a]);c(this.dom.buttons).empty();c.each(a,function(a,k){"string"===typeof k&&(k={label:k,fn:function(){this.submit()}});c("<button/>",{"class":b.classes.form.button+(k.className?" "+k.className:"")}).html(k.label||
"").attr("tabindex",0).on("keyup",function(a){13===a.keyCode&&k.fn&&k.fn.call(b)}).on("keypress",function(a){a.preventDefault()}).on("mousedown",function(a){a.preventDefault()}).on("click",function(a){a.preventDefault();k.fn&&k.fn.call(b)}).appendTo(b.dom.buttons)});return this};e.prototype.clear=function(a){var b=this,d=this.s.fields;if(a)if(c.isArray(a))for(var d=0,k=a.length;d<k;d++)this.clear(a[d]);else d[a].destroy(),delete d[a],a=c.inArray(a,this.s.order),this.s.order.splice(a,1);else c.each(d,
function(a){b.clear(a)});return this};e.prototype.close=function(){this._close(!1);return this};e.prototype.create=function(a,b,d,k){var g=this;if(this._tidy(function(){g.create(a,b,d,k)}))return this;var e=this.s.fields,f=this._crudArgs(a,b,d,k);this.s.action="create";this.s.modifier=null;this.dom.form.style.display="block";this._actionClass();c.each(e,function(a,b){b.set(b.def())});this._event("initCreate");this._assembleMain();this._formOptions(f.opts);f.maybeOpen();return this};e.prototype.disable=
function(a){var b=this.s.fields;c.isArray(a)||(a=[a]);c.each(a,function(a,c){b[c].disable()});return this};e.prototype.display=function(a){return a===h?this.s.displayed:this[a?"open":"close"]()};e.prototype.displayed=function(){return c.map(this.s.fields,function(a,b){return a.displayed()?b:null})};e.prototype.edit=function(a,b,d,c,g){var e=this;if(this._tidy(function(){e.edit(a,b,d,c,g)}))return this;var f=this._crudArgs(b,d,c,g);this._edit(a,"main");this._assembleMain();this._formOptions(f.opts);
f.maybeOpen();return this};e.prototype.enable=function(a){var b=this.s.fields;c.isArray(a)||(a=[a]);c.each(a,function(a,c){b[c].enable()});return this};e.prototype.error=function(a,b){b===h?this._message(this.dom.formError,"fade",a):this.s.fields[a].error(b);return this};e.prototype.field=function(a){return this.s.fields[a]};e.prototype.fields=function(){return c.map(this.s.fields,function(a,b){return b})};e.prototype.get=function(a){var b=this.s.fields;a||(a=this.fields());if(c.isArray(a)){var d=
{};c.each(a,function(a,c){d[c]=b[c].get()});return d}return b[a].get()};e.prototype.hide=function(a,b){a?c.isArray(a)||(a=[a]):a=this.fields();var d=this.s.fields;c.each(a,function(a,c){d[c].hide(b)});return this};e.prototype.inline=function(a,b,d){var e=this;c.isPlainObject(b)&&(d=b,b=h);var d=c.extend({},this.s.formOptions.inline,d),g=this._dataSource("individual",a,b,this.s.fields),w=c(g.node),f=g.field;if(c("div.DTE_Field",w).length||this._tidy(function(){e.inline(a,b,d)}))return this;this._edit(g.edit,
"inline");var n=this._formOptions(d);if(!this._preopen("inline"))return this;var i=w.contents().detach();w.append(c('<div class="DTE DTE_Inline"><div class="DTE_Inline_Field"/><div class="DTE_Inline_Buttons"/></div>'));w.find("div.DTE_Inline_Field").append(f.node());d.buttons&&w.find("div.DTE_Inline_Buttons").append(this.dom.buttons);this._closeReg(function(a){c(m).off("click"+n);if(!a){w.contents().detach();w.append(i)}e._clearDynamicInfo()});c(m).on("click"+n,function(a){c.inArray(w[0],c(a.target).parents().andSelf())===
-1&&e.blur()});this._focus([f],d.focus);this._postopen("inline");return this};e.prototype.message=function(a,b){b===h?this._message(this.dom.formInfo,"fade",a):this.s.fields[a].message(b);return this};e.prototype.modifier=function(){return this.s.modifier};e.prototype.node=function(a){var b=this.s.fields;a||(a=this.order());return c.isArray(a)?c.map(a,function(a){return b[a].node()}):b[a].node()};e.prototype.off=function(a,b){c(this).off(this._eventName(a),b);return this};e.prototype.on=function(a,
b){c(this).on(this._eventName(a),b);return this};e.prototype.one=function(a,b){c(this).one(this._eventName(a),b);return this};e.prototype.open=function(){var a=this;this._displayReorder();this._closeReg(function(){a.s.displayController.close(a,function(){a._clearDynamicInfo()})});this._preopen("main");this.s.displayController.open(this,this.dom.wrapper);this._focus(c.map(this.s.order,function(b){return a.s.fields[b]}),this.s.editOpts.focus);this._postopen("main");return this};e.prototype.order=function(a){if(!a)return this.s.order;
arguments.length&&!c.isArray(a)&&(a=Array.prototype.slice.call(arguments));if(this.s.order.slice().sort().join("-")!==a.slice().sort().join("-"))throw"All fields, and no additional fields, must be provided for ordering.";c.extend(this.s.order,a);this._displayReorder();return this};e.prototype.remove=function(a,b,d,e,g){var f=this;if(this._tidy(function(){f.remove(a,b,d,e,g)}))return this;a.length===h&&(a=[a]);var u=this._crudArgs(b,d,e,g);this.s.action="remove";this.s.modifier=a;this.dom.form.style.display=
"none";this._actionClass();this._event("initRemove",[this._dataSource("node",a),this._dataSource("get",a,this.s.fields),a]);this._assembleMain();this._formOptions(u.opts);u.maybeOpen();u=this.s.editOpts;null!==u.focus&&c("button",this.dom.buttons).eq(u.focus).focus();return this};e.prototype.set=function(a,b){var d=this.s.fields;if(!c.isPlainObject(a)){var e={};e[a]=b;a=e}c.each(a,function(a,b){d[a].set(b)});return this};e.prototype.show=function(a,b){a?c.isArray(a)||(a=[a]):a=this.fields();var d=
this.s.fields;c.each(a,function(a,c){d[c].show(b)});return this};e.prototype.submit=function(a,b,d,e){var g=this,f=this.s.fields,u=[],n=0,h=!1;if(this.s.processing||!this.s.action)return this;this._processing(!0);var i=function(){u.length!==n||h||(h=!0,g._submit(a,b,d,e))};this.error();c.each(f,function(a,b){b.inError()&&u.push(a)});c.each(u,function(a,b){f[b].error("",function(){n++;i()})});i();return this};e.prototype.title=function(a){var b=c(this.dom.header).children("div."+this.classes.header.content);
if(a===h)return b.html();b.html(a);return this};e.prototype.val=function(a,b){return b===h?this.get(a):this.set(a,b)};var j=v.Api.register;j("editor()",function(){return x(this)});j("row.create()",function(a){var b=x(this);b.create(z(b,a,"create"))});j("row().edit()",function(a){var b=x(this);b.edit(this[0][0],z(b,a,"edit"))});j("row().delete()",function(a){var b=x(this);b.remove(this[0][0],z(b,a,"remove",1))});j("rows().delete()",function(a){var b=x(this);b.remove(this[0],z(b,a,"remove",this[0].length))});
j("cell().edit()",function(a){x(this).inline(this[0][0],a)});j("cells().edit()",function(a){x(this).bubble(this[0],a)});e.pairs=function(a,b,d){var e,g,f,b=c.extend({label:"label",value:"value"},b);if(c.isArray(a)){e=0;for(g=a.length;e<g;e++)f=a[e],c.isPlainObject(f)?d(f[b.value]===h?f[b.label]:f[b.value],f[b.label],e):d(f,f,e)}else e=0,c.each(a,function(a,b){d(b,a,e);e++})};e.safeId=function(a){return a.replace(".","-")};e.prototype._constructor=function(a){a=c.extend(!0,{},e.defaults,a);this.s=
c.extend(!0,{},e.models.settings,{table:a.domTable||a.table,dbTable:a.dbTable||null,ajaxUrl:a.ajaxUrl,ajax:a.ajax,idSrc:a.idSrc,dataSource:a.domTable||a.table?e.dataSources.dataTable:e.dataSources.html,formOptions:a.formOptions});this.classes=c.extend(!0,{},e.classes);this.i18n=a.i18n;var b=this,d=this.classes;this.dom={wrapper:c('<div class="'+d.wrapper+'"><div data-dte-e="processing" class="'+d.processing.indicator+'"></div><div data-dte-e="body" class="'+d.body.wrapper+'"><div data-dte-e="body_content" class="'+
d.body.content+'"/></div><div data-dte-e="foot" class="'+d.footer.wrapper+'"><div class="'+d.footer.content+'"/></div></div>')[0],form:c('<form data-dte-e="form" class="'+d.form.tag+'"><div data-dte-e="form_content" class="'+d.form.content+'"/></form>')[0],formError:c('<div data-dte-e="form_error" class="'+d.form.error+'"/>')[0],formInfo:c('<div data-dte-e="form_info" class="'+d.form.info+'"/>')[0],header:c('<div data-dte-e="head" class="'+d.header.wrapper+'"><div class="'+d.header.content+'"/></div>')[0],
buttons:c('<div data-dte-e="form_buttons" class="'+d.form.buttons+'"/>')[0]};if(c.fn.dataTable.TableTools){var k=c.fn.dataTable.TableTools.BUTTONS,g=this.i18n;c.each(["create","edit","remove"],function(a,b){k["editor_"+b].sButtonText=g[b].button})}c.each(a.events,function(a,c){b.on(a,function(){var a=Array.prototype.slice.call(arguments);a.shift();c.apply(b,a)})});var d=this.dom,f=d.wrapper;d.formContent=s("form_content",d.form)[0];d.footer=s("foot",f)[0];d.body=s("body",f)[0];d.bodyContent=s("body_content",
f)[0];d.processing=s("processing",f)[0];a.fields&&this.add(a.fields);c(m).one("init.dt.dte",function(a,d){b.s.table&&d.nTable===c(b.s.table).get(0)&&(d._editor=b)}).on("xhr.dt",function(a,d,e){b.s.table&&d.nTable===c(b.s.table).get(0)&&b._optionsUpdate(e)});this.s.displayController=e.display[a.display].init(this);this._event("initComplete",[])};e.prototype._actionClass=function(){var a=this.classes.actions,b=this.s.action,d=c(this.dom.wrapper);d.removeClass([a.create,a.edit,a.remove].join(" "));"create"===
b?d.addClass(a.create):"edit"===b?d.addClass(a.edit):"remove"===b&&d.addClass(a.remove)};e.prototype._ajax=function(a,b,d){var e={type:"POST",dataType:"json",data:null,success:b,error:d},g,f=this.s.action,h=this.s.ajax||this.s.ajaxUrl,f="edit"===f||"remove"===f?this._dataSource("id",this.s.modifier):null;c.isArray(f)&&(f=f.join(","));c.isPlainObject(h)&&h.create&&(h=h[this.s.action]);if(c.isFunction(h)){e=g=null;if(this.s.ajaxUrl){var i=this.s.ajaxUrl;i.create&&(g=i[this.s.action]);-1!==g.indexOf(" ")&&
(g=g.split(" "),e=g[0],g=g[1]);g=g.replace(/_id_/,f)}h(e,g,a,b,d)}else"string"===typeof h?-1!==h.indexOf(" ")?(g=h.split(" "),e.type=g[0],e.url=g[1]):e.url=h:e=c.extend({},e,h||{}),e.url=e.url.replace(/_id_/,f),e.data&&(b=c.isFunction(e.data)?e.data(a):e.data,a=c.isFunction(e.data)&&b?b:c.extend(!0,a,b)),e.data=a,c.ajax(e)};e.prototype._assembleMain=function(){var a=this.dom;c(a.wrapper).prepend(a.header);c(a.footer).append(a.formError).append(a.buttons);c(a.bodyContent).append(a.formInfo).append(a.form)};
e.prototype._blur=function(){var a=this.s.editOpts;a.blurOnBackground&&!1!==this._event("preBlur")&&(a.submitOnBlur?this.submit():this._close())};e.prototype._clearDynamicInfo=function(){var a=this.classes.field.error,b=this.s.fields;c("div."+a,this.dom.wrapper).removeClass(a);c.each(b,function(a,b){b.error("").message("")});this.error("").message("")};e.prototype._close=function(a){!1!==this._event("preClose")&&(this.s.closeCb&&(this.s.closeCb(a),this.s.closeCb=null),this.s.closeIcb&&(this.s.closeIcb(),
this.s.closeIcb=null),c("html").off("focus.editor-focus"),this.s.displayed=!1,this._event("close"))};e.prototype._closeReg=function(a){this.s.closeCb=a};e.prototype._crudArgs=function(a,b,d,e){var g=this,f,i,n;c.isPlainObject(a)||("boolean"===typeof a?(n=a,a=b):(f=a,i=b,n=d,a=e));n===h&&(n=!0);f&&g.title(f);i&&g.buttons(i);return{opts:c.extend({},this.s.formOptions.main,a),maybeOpen:function(){n&&g.open()}}};e.prototype._dataSource=function(a){var b=Array.prototype.slice.call(arguments);b.shift();
var c=this.s.dataSource[a];if(c)return c.apply(this,b)};e.prototype._displayReorder=function(a){var b=c(this.dom.formContent),d=this.s.fields,a=a||this.s.order;b.children().detach();c.each(a,function(a,c){b.append(c instanceof e.Field?c.node():d[c].node())})};e.prototype._edit=function(a,b){var d=this.s.fields,e=this._dataSource("get",a,d);this.s.modifier=a;this.s.action="edit";this.dom.form.style.display="block";this._actionClass();c.each(d,function(a,b){var c=b.valFromData(e);b.set(c!==h?c:b.def())});
this._event("initEdit",[this._dataSource("node",a),e,a,b])};e.prototype._event=function(a,b){b||(b=[]);if(c.isArray(a))for(var d=0,e=a.length;d<e;d++)this._event(a[d],b);else return d=c.Event(a),c(this).triggerHandler(d,b),d.result};e.prototype._eventName=function(a){for(var b=a.split(" "),c=0,e=b.length;c<e;c++){var a=b[c],g=a.match(/^on([A-Z])/);g&&(a=g[1].toLowerCase()+a.substring(3));b[c]=a}return b.join(" ")};e.prototype._focus=function(a,b){var d;"number"===typeof b?d=a[b]:b&&(d=0===b.indexOf("jq:")?
c("div.DTE "+b.replace(/^jq:/,"")):this.s.fields[b].focus());(this.s.setFocus=d)&&d.focus()};e.prototype._formOptions=function(a){var b=this,d=y++,e=".dteInline"+d;this.s.editOpts=a;this.s.editCount=d;"string"===typeof a.title&&(this.title(a.title),a.title=!0);"string"===typeof a.message&&(this.message(a.message),a.message=!0);"boolean"!==typeof a.buttons&&(this.buttons(a.buttons),a.buttons=!0);c(m).on("keydown"+e,function(d){var e=c(m.activeElement),f=e[0].nodeName.toLowerCase(),k=c(e).attr("type"),
f=f==="input"&&c.inArray(k,["color","date","datetime","datetime-local","email","month","number","password","range","search","tel","text","time","url","week"])!==-1;if(b.s.displayed&&a.submitOnReturn&&d.keyCode===13&&f){d.preventDefault();b.submit()}else if(d.keyCode===27){d.preventDefault();switch(a.onEsc){case "blur":b.blur();break;case "close":b.close();break;case "submit":b.submit()}}else e.parents(".DTE_Form_Buttons").length&&(d.keyCode===37?e.prev("button").focus():d.keyCode===39&&e.next("button").focus())});
this.s.closeIcb=function(){c(m).off("keydown"+e)};return e};e.prototype._optionsUpdate=function(a){var b=this;a.options&&c.each(this.s.fields,function(c){a.options[c]!==h&&b.field(c).update(a.options[c])})};e.prototype._message=function(a,b,d){!d&&this.s.displayed?"slide"===b?c(a).slideUp():c(a).fadeOut():d?this.s.displayed?"slide"===b?c(a).html(d).slideDown():c(a).html(d).fadeIn():(c(a).html(d),a.style.display="block"):a.style.display="none"};e.prototype._postopen=function(a){var b=this;c(this.dom.form).off("submit.editor-internal").on("submit.editor-internal",
function(a){a.preventDefault()});if("main"===a||"bubble"===a)c("html").on("focus.editor-focus","body",function(){0===c(m.activeElement).parents(".DTE").length&&0===c(m.activeElement).parents(".DTED").length&&b.s.setFocus&&b.s.setFocus.focus()});this._event("open",[a]);return!0};e.prototype._preopen=function(a){if(!1===this._event("preOpen",[a]))return!1;this.s.displayed=a;return!0};e.prototype._processing=function(a){var b=c(this.dom.wrapper),d=this.dom.processing.style,e=this.classes.processing.active;
a?(d.display="block",b.addClass(e),c("div.DTE").addClass(e)):(d.display="none",b.removeClass(e),c("div.DTE").removeClass(e));this.s.processing=a;this._event("processing",[a])};e.prototype._submit=function(a,b,d,e){var g=this,f=v.ext.oApi._fnSetObjectDataFn,i={},l=this.s.fields,j=this.s.action,o=this.s.editCount,p=this.s.modifier,m={action:this.s.action,data:{}};this.s.dbTable&&(m.table=this.s.dbTable);if("create"===j||"edit"===j)c.each(l,function(a,b){f(b.name())(m.data,b.get())}),c.extend(!0,i,m.data);
if("edit"===j||"remove"===j)m.id=this._dataSource("id",p),"edit"===j&&c.isArray(m.id)&&(m.id=m.id[0]);d&&d(m);!1===this._event("preSubmit",[m,j])?this._processing(!1):this._ajax(m,function(d){var r;g._event("postSubmit",[d,m,j]);if(!d.error)d.error="";if(!d.fieldErrors)d.fieldErrors=[];if(d.error||d.fieldErrors.length){g.error(d.error);c.each(d.fieldErrors,function(a,b){var d=l[b.name];d.error(b.status||"Error");if(a===0){c(g.dom.bodyContent,g.s.wrapper).animate({scrollTop:c(d.node()).position().top},
500);d.focus()}});b&&b.call(g,d)}else{r=d.row!==h?d.row:i;g._event("setData",[d,r,j]);if(j==="create"){g.s.idSrc===null&&d.id?r.DT_RowId=d.id:d.id&&f(g.s.idSrc)(r,d.id);g._event("preCreate",[d,r]);g._dataSource("create",l,r);g._event(["create","postCreate"],[d,r])}else if(j==="edit"){g._event("preEdit",[d,r]);g._dataSource("edit",p,l,r);g._event(["edit","postEdit"],[d,r])}else if(j==="remove"){g._event("preRemove",[d]);g._dataSource("remove",p,l);g._event(["remove","postRemove"],[d])}if(o===g.s.editCount){g.s.action=
null;g.s.editOpts.closeOnComplete&&(e===h||e)&&g._close(true)}a&&a.call(g,d);g._event("submitSuccess",[d,r])}g._processing(false);g._event("submitComplete",[d,r])},function(a,d,c){g._event("postSubmit",[a,d,c,m]);g.error(g.i18n.error.system);g._processing(false);b&&b.call(g,a,d,c);g._event(["submitError","submitComplete"],[a,d,c,m])})};e.prototype._tidy=function(a){return this.s.processing?(this.one("submitComplete",a),!0):c("div.DTE_Inline").length?(this.off("close.killInline").one("close.killInline",
a).blur(),!0):!1};e.defaults={table:null,ajaxUrl:null,fields:[],display:"lightbox",ajax:null,idSrc:null,events:{},i18n:{create:{button:"New",title:"Create new entry",submit:"Create"},edit:{button:"Edit",title:"Edit entry",submit:"Update"},remove:{button:"Delete",title:"Delete",submit:"Delete",confirm:{_:"Are you sure you wish to delete %d rows?",1:"Are you sure you wish to delete 1 row?"}},error:{system:'A system error has occurred (<a target="_blank" href="//datatables.net/tn/12">More information</a>).'}},
formOptions:{bubble:c.extend({},e.models.formOptions,{title:!1,message:!1,buttons:"_basic"}),inline:c.extend({},e.models.formOptions,{buttons:!1}),main:c.extend({},e.models.formOptions)}};var A=function(a,b,d){c.each(b,function(a,b){c('[data-editor-field="'+b.dataSrc()+'"]').html(b.valFromData(d))})},j=e.dataSources={},B=function(a){a=c(a);setTimeout(function(){a.addClass("highlight");setTimeout(function(){a.addClass("noHighlight").removeClass("highlight");setTimeout(function(){a.removeClass("noHighlight")},
550)},500)},20)},C=function(a,b,d){if(b&&b.length!==h)return c.map(b,function(b){return C(a,b,d)});var e=v.ext.oApi,b=c(a).DataTable().row(b);return null===d?(e=b.data(),e.DT_RowId!==h?e.DT_RowId:b.node().id):e._fnGetObjectDataFn(d)(b.data())};j.dataTable={id:function(a){return C(this.s.table,a,this.s.idSrc)},get:function(a){var b=c(this.s.table).DataTable().rows(a).data().toArray();return c.isArray(a)?b:b[0]},node:function(a){var b=c(this.s.table).DataTable().rows(a).nodes().toArray();return c.isArray(a)?
b:b[0]},individual:function(a,b,d){var e=c(this.s.table).DataTable(),g,f;c(a).hasClass("dtr-data")?f=e.responsive.index(c(a).closest("li")):(a=e.cell(a),f=a.index(),a=a.node());if(d){if(b)g=d[b];else{var b=e.settings()[0].aoColumns[f.column],h=b.editField||b.mData;c.each(d,function(a,b){b.dataSrc()===h&&(g=b)})}if(!g)throw"Unable to automatically determine field from source. Please specify the field name";}return{node:a,edit:f.row,field:g}},create:function(a,b){var d=c(this.s.table).DataTable();if(d.settings()[0].oFeatures.bServerSide)d.draw();
else if(null!==b){var e=d.row.add(b);d.draw();B(e.node())}},edit:function(a,b,d){b=c(this.s.table).DataTable();b.settings()[0].oFeatures.bServerSide?b.draw(!1):(a=b.row(a),null===d?a.remove().draw(!1):(a.data(d).draw(!1),B(a.node())))},remove:function(a){var b=c(this.s.table).DataTable();b.settings()[0].oFeatures.bServerSide?b.draw():b.rows(a).remove().draw()}};j.html={id:function(a){return a},initField:function(a){var b=c('[data-editor-label="'+(a.data||a.name)+'"]');!a.label&&b.length&&(a.label=
b.html())},get:function(a,b){var d={};c.each(b,function(a,b){var e=c('[data-editor-field="'+b.dataSrc()+'"]').html();b.valToData(d,null===e?h:e)});return d},node:function(){return m},individual:function(a,b,d){"string"===typeof a?(b=a,c('[data-editor-field="'+b+'"]')):b=c(a).attr("data-editor-field");a=c('[data-editor-field="'+b+'"]');return{node:a[0],edit:a.parents("[data-editor-id]").data("editor-id"),field:d?d[b]:null}},create:function(a,b){A(null,a,b)},edit:function(a,b,d){A(a,b,d)}};j.js={id:function(a){return a},
get:function(a,b){var d={};c.each(b,function(a,b){b.valToData(d,b.val())});return d},node:function(){return m}};e.classes={wrapper:"DTE",processing:{indicator:"DTE_Processing_Indicator",active:"DTE_Processing"},header:{wrapper:"DTE_Header",content:"DTE_Header_Content"},body:{wrapper:"DTE_Body",content:"DTE_Body_Content"},footer:{wrapper:"DTE_Footer",content:"DTE_Footer_Content"},form:{wrapper:"DTE_Form",content:"DTE_Form_Content",tag:"",info:"DTE_Form_Info",error:"DTE_Form_Error",buttons:"DTE_Form_Buttons",
button:"btn"},field:{wrapper:"DTE_Field",typePrefix:"DTE_Field_Type_",namePrefix:"DTE_Field_Name_",label:"DTE_Label",input:"DTE_Field_Input",error:"DTE_Field_StateError","msg-label":"DTE_Label_Info","msg-error":"DTE_Field_Error","msg-message":"DTE_Field_Message","msg-info":"DTE_Field_Info"},actions:{create:"DTE_Action_Create",edit:"DTE_Action_Edit",remove:"DTE_Action_Remove"},bubble:{wrapper:"DTE DTE_Bubble",liner:"DTE_Bubble_Liner",table:"DTE_Bubble_Table",close:"DTE_Bubble_Close",pointer:"DTE_Bubble_Triangle",
bg:"DTE_Bubble_Background"}};c.fn.dataTable.TableTools&&(j=c.fn.dataTable.TableTools.BUTTONS,j.editor_create=c.extend(!0,j.text,{sButtonText:null,editor:null,formTitle:null,formButtons:[{label:null,fn:function(){this.submit()}}],fnClick:function(a,b){var d=b.editor,c=d.i18n.create,e=b.formButtons;if(!e[0].label)e[0].label=c.submit;d.title(c.title).buttons(e).create()}}),j.editor_edit=c.extend(!0,j.select_single,{sButtonText:null,editor:null,formTitle:null,formButtons:[{label:null,fn:function(){this.submit()}}],
fnClick:function(a,b){var c=this.fnGetSelectedIndexes();if(c.length===1){var e=b.editor,f=e.i18n.edit,h=b.formButtons;if(!h[0].label)h[0].label=f.submit;e.title(f.title).buttons(h).edit(c[0])}}}),j.editor_remove=c.extend(!0,j.select,{sButtonText:null,editor:null,formTitle:null,formButtons:[{label:null,fn:function(){var a=this;this.submit(function(){c.fn.dataTable.TableTools.fnGetInstance(c(a.s.table).DataTable().table().node()).fnSelectNone()})}}],question:null,fnClick:function(a,b){var c=this.fnGetSelectedIndexes();
if(c.length!==0){var e=b.editor,f=e.i18n.remove,h=b.formButtons,i=f.confirm==="string"?f.confirm:f.confirm[c.length]?f.confirm[c.length]:f.confirm._;if(!h[0].label)h[0].label=f.submit;e.message(i.replace(/%d/g,c.length)).title(f.title).buttons(h).remove(c)}}}));e.fieldTypes={};var p=e.fieldTypes,j=c.extend(!0,{},e.models.fieldType,{get:function(a){return a._input.val()},set:function(a,b){a._input.val(b).trigger("change")},enable:function(a){a._input.prop("disabled",false)},disable:function(a){a._input.prop("disabled",
true)}});p.hidden=c.extend(!0,{},j,{create:function(a){a._val=a.value;return null},get:function(a){return a._val},set:function(a,b){a._val=b}});p.readonly=c.extend(!0,{},j,{create:function(a){a._input=c("<input/>").attr(c.extend({id:e.safeId(a.id),type:"text",readonly:"readonly"},a.attr||{}));return a._input[0]}});p.text=c.extend(!0,{},j,{create:function(a){a._input=c("<input/>").attr(c.extend({id:e.safeId(a.id),type:"text"},a.attr||{}));return a._input[0]}});p.password=c.extend(!0,{},j,{create:function(a){a._input=
c("<input/>").attr(c.extend({id:e.safeId(a.id),type:"password"},a.attr||{}));return a._input[0]}});p.textarea=c.extend(!0,{},j,{create:function(a){a._input=c("<textarea/>").attr(c.extend({id:e.safeId(a.id)},a.attr||{}));return a._input[0]}});p.select=c.extend(!0,{},j,{_addOptions:function(a,b){var c=a._input[0].options;c.length=0;b&&e.pairs(b,a.optionsPair,function(a,b,e){c[e]=new Option(b,a)})},create:function(a){a._input=c("<select/>").attr(c.extend({id:e.safeId(a.id)},a.attr||{}));p.select._addOptions(a,
a.options||a.ipOpts);return a._input[0]},update:function(a,b){var d=c(a._input).val();p.select._addOptions(a,b);c(a._input).val(d)}});p.checkbox=c.extend(!0,{},j,{_addOptions:function(a,b){var c=a._input.empty();b&&e.pairs(b,a.optionsPair,function(b,f,h){c.append('<div><input id="'+e.safeId(a.id)+"_"+h+'" type="checkbox" value="'+b+'" /><label for="'+e.safeId(a.id)+"_"+h+'">'+f+"</label></div>")})},create:function(a){a._input=c("<div />");p.checkbox._addOptions(a,a.options||a.ipOpts);return a._input[0]},
get:function(a){var b=[];a._input.find("input:checked").each(function(){b.push(this.value)});return a.separator?b.join(a.separator):b},set:function(a,b){var d=a._input.find("input");!c.isArray(b)&&typeof b==="string"?b=b.split(a.separator||"|"):c.isArray(b)||(b=[b]);var e,f=b.length,h;d.each(function(){h=false;for(e=0;e<f;e++)if(this.value==b[e]){h=true;break}this.checked=h}).change()},enable:function(a){a._input.find("input").prop("disabled",false)},disable:function(a){a._input.find("input").prop("disabled",
true)},update:function(a,b){var c=p.checkbox.get(a);p.checkbox._addOptions(a,b);p.checkbox.set(a,c)}});p.radio=c.extend(!0,{},j,{_addOptions:function(a,b){var d=a._input.empty();b&&e.pairs(b,a.optionsPair,function(b,f,h){d.append('<div><input id="'+e.safeId(a.id)+"_"+h+'" type="radio" name="'+a.name+'" /><label for="'+e.safeId(a.id)+"_"+h+'">'+f+"</label></div>");c("input:last",d).attr("value",b)[0]._editor_val=b})},create:function(a){a._input=c("<div />");p.radio._addOptions(a,a.options||a.ipOpts);
this.on("open",function(){a._input.find("input").each(function(){if(this._preChecked)this.checked=true})});return a._input[0]},get:function(a){a=a._input.find("input:checked");return a.length?a[0]._editor_val:h},set:function(a,b){a._input.find("input").each(function(){this._preChecked=false;if(this._editor_val==b)this._preChecked=this.checked=true;else this._preChecked=this.checked=false});a._input.find("input:checked").change()},enable:function(a){a._input.find("input").prop("disabled",false)},disable:function(a){a._input.find("input").prop("disabled",
true)},update:function(a,b){var c=p.radio.get(a);p.radio._addOptions(a,b);p.radio.set(a,c)}});p.date=c.extend(!0,{},j,{create:function(a){if(!c.datepicker){a._input=c("<input/>").attr(c.extend({id:e.safeId(a.id),type:"date"},a.attr||{}));return a._input[0]}a._input=c("<input />").attr(c.extend({type:"text",id:e.safeId(a.id),"class":"jqueryui"},a.attr||{}));if(!a.dateFormat)a.dateFormat=c.datepicker.RFC_2822;if(a.dateImage===h)a.dateImage="../../images/calender.png";setTimeout(function(){c(a._input).datepicker(c.extend({showOn:"both",
dateFormat:a.dateFormat,buttonImage:a.dateImage,buttonImageOnly:true},a.opts));c("#ui-datepicker-div").css("display","none")},10);return a._input[0]},set:function(a,b){c.datepicker?a._input.datepicker("setDate",b).change():c(a._input).val(b)},enable:function(a){c.datepicker?a._input.datepicker("enable"):c(a._input).prop("disable",false)},disable:function(a){c.datepicker?a._input.datepicker("disable"):c(a._input).prop("disable",true)}});e.prototype.CLASS="Editor";e.version="1.4.0-beta";return e};"function"===
typeof define&&define.amd?define(["jquery","datatables"],y):"object"===typeof exports?y(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.Editor&&y(jQuery,jQuery.fn.dataTable)})(window,document);
